select concat(concat(extract(year from cc.transaction_date),'-'),extract(month from cc.transaction_date)) AS YEAR_MONTH,
cc.product_code,cc.icplus_type,pc.product_name
from fdwo.CC_PROCESSING_DATA_PT cc
left join 
(select p.PRODUCT_CODE, p.PRODUCT_NAME
from FDWO.MB_PRODUCT_CODE p
WHERE p.PRODUCT_CODE IN (100809,100819,100740,100450,100483,100486,100443,100805,100447,100444,100445,100800,100441,100440,100448
,100442,100369,100370,100823,100825,100830,100826,100827,100828,100824,100821,100820,100831,100822,100870,100436,100741,100453
,100815,100457,100454,100455,100810,100451,100458,100452,100843,100845,100846,100847,100848,100841,100840,100833,100842,100375
,100366,100373,900600,100360,900601,100742,100355,100487,100484,100481,100480,100485,100482,100850,100860,100849,100743,100746
,100744,100832,100844,100368,100851,100750,100809,100819,100740,100450,100483,100486,100443,100805,100447,100444,100445,100800
,100441,100440,100448,100442,100369,100370,100823,100825,100830,100826,100827,100828,100824,100821,100820,100831,100822,100870
,100436,100741,100453,100815,100457,100454,100455,100810,100451,100458,100452,100843,100845,100846,100847,100848,100841,100840
,100833,100842,100375,100366,100373,900600,100360,900601,100742,100355,100487,100484,100481,100480,100485,100482,100850,100860
,100849,100743,100746,100744,100832,100844,100368,100851,100750,100852,100751,100755,100753,100756,900610,100754,100752)
GROUP BY PRODUCT_CODE, PRODUCT_NAME) pc
on CC.PRODUCT_CODE =pc.product_code
left join
(select GM.RELATION_ID,GM.PRODUCT_CODE
from fdwo.GM_CALCULATION_2 gm
where GM.INVOICE_DATE>=To_date('1/1/2018','MM/DD/YYYY')
GROUP BY GM.RELATION_ID,GM.PRODUCT_CODE) g
on CC.PRODUCT_CODE=g.PRODUCT_CODE
where transaction_date>=to_date('1/1/2018','MM/DD/YYYY')
group by cc.transaction_date,cc.product_code,cc.icplus_type,pc.product_name;

select GM.RELATION_ID,GM.PRODUCT_CODE
from fdwo.GM_CALCULATION_2 gm
where GM.INVOICE_DATE>=To_date('1/1/2018','MM/DD/YYYY') g
